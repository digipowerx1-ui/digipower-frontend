{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/purujitvij/Documents/BrewingCode/nextjs/digipower-frontend/src/app/api/stock/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\n\nconst BACKEND_API_URL = process.env.BACKEND_API_URL || 'http://ec2-51-20-254-227.eu-north-1.compute.amazonaws.com';\n\nexport async function GET(request: Request) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const symbol = searchParams.get('symbol')?.toUpperCase() || 'DGXX';\n    const date = searchParams.get('date');\n\n    if (!date) {\n      return NextResponse.json(\n        { error: 'Date parameter is required (YYYY-MM-DD format)' },\n        { status: 400 }\n      );\n    }\n\n    const response = await fetch(\n      `${BACKEND_API_URL}/api/stock?symbol=${symbol}&date=${date}`,\n      {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        cache: 'no-store',\n      }\n    );\n\n    if (!response.ok) {\n      if (response.status === 404) {\n        return NextResponse.json(\n          { error: 'No data available for the specified date' },\n          { status: 404 }\n        );\n      }\n      throw new Error(`Backend returned ${response.status}`);\n    }\n\n    const data = await response.json();\n\n    // Add caching headers - historical stock data can be cached longer\n    // Cache for 1 hour on client, 24 hours on CDN (data doesn't change for past dates)\n    return NextResponse.json(data, {\n      headers: {\n        'Cache-Control': 'public, max-age=3600, s-maxage=86400, stale-while-revalidate=86400',\n      },\n    });\n  } catch (error) {\n    console.error('Error proxying to backend:', error);\n    return NextResponse.json(\n      {\n        error: 'Failed to fetch stock data',\n        message: error instanceof Error ? error.message : 'Unknown error',\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB,QAAQ,GAAG,CAAC,eAAe,IAAI;AAEhD,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,SAAS,aAAa,GAAG,CAAC,WAAW,iBAAiB;QAC5D,MAAM,OAAO,aAAa,GAAG,CAAC;QAE9B,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAiD,GAC1D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,WAAW,MAAM,MACrB,GAAG,gBAAgB,kBAAkB,EAAE,OAAO,MAAM,EAAE,MAAM,EAC5D;YACE,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,OAAO;QACT;QAGF,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,IAAI,SAAS,MAAM,KAAK,KAAK;gBAC3B,OAAO,gJAAY,CAAC,IAAI,CACtB;oBAAE,OAAO;gBAA2C,GACpD;oBAAE,QAAQ;gBAAI;YAElB;YACA,MAAM,IAAI,MAAM,CAAC,iBAAiB,EAAE,SAAS,MAAM,EAAE;QACvD;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,mEAAmE;QACnE,mFAAmF;QACnF,OAAO,gJAAY,CAAC,IAAI,CAAC,MAAM;YAC7B,SAAS;gBACP,iBAAiB;YACnB;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}