{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/purujitvij/Documents/BrewingCode/nextjs/digipower-frontend/src/app/api/revalidate/route.ts"],"sourcesContent":["import { revalidatePath } from 'next/cache';\nimport { NextResponse } from 'next/server';\n\n// Secret token to secure the webhook - set this in your environment variables\nconst REVALIDATION_SECRET = process.env.REVALIDATION_SECRET;\n\nexport async function POST(request: Request) {\n  try {\n    // Get the secret from query params or headers\n    const { searchParams } = new URL(request.url);\n    const secret = searchParams.get('secret') || request.headers.get('x-revalidation-secret');\n\n    // Validate the secret token\n    if (REVALIDATION_SECRET && secret !== REVALIDATION_SECRET) {\n      return NextResponse.json(\n        { error: 'Invalid secret token' },\n        { status: 401 }\n      );\n    }\n\n    // Parse the request body to get the content type\n    let body: { model?: string; entry?: { id?: number } } = {};\n    try {\n      body = await request.json();\n    } catch {\n      // Body might be empty for simple revalidation calls\n    }\n\n    const model = body.model?.toLowerCase() || searchParams.get('model')?.toLowerCase();\n    const paths: string[] = [];\n\n    // Determine which paths to revalidate based on the Strapi model\n    switch (model) {\n      case 'press-release':\n      case 'press-releases':\n        paths.push('/press-releases');\n        paths.push('/investor-relations'); // Also shows press releases\n        // If a specific entry was updated, revalidate its detail page too\n        if (body.entry?.id) {\n          paths.push(`/press-releases/${body.entry.id}`);\n        }\n        break;\n\n      case 'sec-filing':\n      case 'sec-filings':\n        paths.push('/sec-filings');\n        break;\n\n      case 'open-position':\n      case 'open-positions':\n        paths.push('/career');\n        break;\n\n      default:\n        // If no specific model, revalidate common pages\n        if (!model) {\n          paths.push('/press-releases');\n          paths.push('/sec-filings');\n          paths.push('/investor-relations');\n        }\n    }\n\n    // Revalidate all the paths\n    for (const path of paths) {\n      revalidatePath(path);\n    }\n\n    console.log(`[Revalidation] Triggered for model: ${model || 'all'}, paths: ${paths.join(', ')}`);\n\n    return NextResponse.json({\n      revalidated: true,\n      paths,\n      timestamp: new Date().toISOString(),\n    });\n  } catch (error) {\n    console.error('Error during revalidation:', error);\n    return NextResponse.json(\n      {\n        error: 'Failed to revalidate',\n        message: error instanceof Error ? error.message : 'Unknown error',\n      },\n      { status: 500 }\n    );\n  }\n}\n\n// Also support GET for easy manual testing\nexport async function GET(request: Request) {\n  return POST(request);\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,8EAA8E;AAC9E,MAAM,sBAAsB,QAAQ,GAAG,CAAC,mBAAmB;AAEpD,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,8CAA8C;QAC9C,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,SAAS,aAAa,GAAG,CAAC,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;QAEjE,4BAA4B;QAC5B,IAAI,uBAAuB,WAAW,qBAAqB;YACzD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAuB,GAChC;gBAAE,QAAQ;YAAI;QAElB;QAEA,iDAAiD;QACjD,IAAI,OAAoD,CAAC;QACzD,IAAI;YACF,OAAO,MAAM,QAAQ,IAAI;QAC3B,EAAE,OAAM;QACN,oDAAoD;QACtD;QAEA,MAAM,QAAQ,KAAK,KAAK,EAAE,iBAAiB,aAAa,GAAG,CAAC,UAAU;QACtE,MAAM,QAAkB,EAAE;QAE1B,gEAAgE;QAChE,OAAQ;YACN,KAAK;YACL,KAAK;gBACH,MAAM,IAAI,CAAC;gBACX,MAAM,IAAI,CAAC,wBAAwB,4BAA4B;gBAC/D,kEAAkE;gBAClE,IAAI,KAAK,KAAK,EAAE,IAAI;oBAClB,MAAM,IAAI,CAAC,CAAC,gBAAgB,EAAE,KAAK,KAAK,CAAC,EAAE,EAAE;gBAC/C;gBACA;YAEF,KAAK;YACL,KAAK;gBACH,MAAM,IAAI,CAAC;gBACX;YAEF,KAAK;YACL,KAAK;gBACH,MAAM,IAAI,CAAC;gBACX;YAEF;gBACE,gDAAgD;gBAChD,IAAI,CAAC,OAAO;oBACV,MAAM,IAAI,CAAC;oBACX,MAAM,IAAI,CAAC;oBACX,MAAM,IAAI,CAAC;gBACb;QACJ;QAEA,2BAA2B;QAC3B,KAAK,MAAM,QAAQ,MAAO;YACxB,IAAA,iJAAc,EAAC;QACjB;QAEA,QAAQ,GAAG,CAAC,CAAC,oCAAoC,EAAE,SAAS,MAAM,SAAS,EAAE,MAAM,IAAI,CAAC,OAAO;QAE/F,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,aAAa;YACb;YACA,WAAW,IAAI,OAAO,WAAW;QACnC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF;AAGO,eAAe,IAAI,OAAgB;IACxC,OAAO,KAAK;AACd"}}]
}